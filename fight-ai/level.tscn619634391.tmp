[gd_scene load_steps=13 format=3 uid="uid://bip7oto81tudp"]

[ext_resource type="PackedScene" uid="uid://x8olpx362ja5" path="res://Agent.tscn" id="1_u52ul"]

[sub_resource type="GDScript" id="GDScript_vonw3"]
script/source = "extends Node3D

#@export var red : CharacterBody3D
#@export var blue : CharacterBody3D
var red
var blue

var red_current_action
var blue_current_action
#@onready var red = get_node(\"Red\")
#@onready var blue = get_node(\"Blue\")
var min_range = 3.0
var speed = 4.0

var red_aggression = 1.3
var red_mobility = 1
var blue_aggression = 1
var blue_mobility = 1.3

func get_current_action(tag):
	if (tag == \"Red\"):
		return red_current_action
	elif (tag == \"Blue\"):
		return blue_current_action

func set_current_action(tag, action):
	if (tag == \"Red\"):
		red_current_action = action
	elif (tag == \"Blue\"):
		blue_current_action = action

#func _ready() -> void:
	#red = get_node(\"Red\")
	#blue = get_node(\"Blue\")
"

[sub_resource type="ProceduralSkyMaterial" id="ProceduralSkyMaterial_5xgho"]
sky_horizon_color = Color(0.662243, 0.671743, 0.686743, 1)
ground_horizon_color = Color(0.662243, 0.671743, 0.686743, 1)

[sub_resource type="Sky" id="Sky_u52ul"]
sky_material = SubResource("ProceduralSkyMaterial_5xgho")

[sub_resource type="Environment" id="Environment_vonw3"]
background_mode = 2
sky = SubResource("Sky_u52ul")
tonemap_mode = 2
glow_enabled = true

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_5xgho"]
albedo_color = Color(0.00533333, 0, 0.04, 1)

[sub_resource type="BoxMesh" id="BoxMesh_u52ul"]
material = SubResource("StandardMaterial3D_5xgho")
size = Vector3(30, 0.2, 30)

[sub_resource type="BoxShape3D" id="BoxShape3D_vonw3"]
size = Vector3(30, 0.2, 30)

[sub_resource type="GDScript" id="GDScript_oi3di"]
script/source = "extends CharacterBody3D

var GetInEnemyRange
var Attack
var CheckEnemyRange
var Fallback
var RSel
var Stall
var enemy
var tag	 = \"Blue\"


func _ready():
	_load()
	

func _load():
	Blackboard.blue = self
	enemy = Blackboard.red
	
	Fallback = AllNodes.fallback.new(self, enemy)
	GetInEnemyRange = AllNodes.get_in_enemy_range.new(self, enemy)
	Attack = AllNodes.attack.new(self)
	Stall = AllNodes.stall.new(self, enemy)
	RSel = AllNodes.RandomSel.new(self, enemy, [Stall, Fallback, Attack], [Blackboard.blue_mobility, Blackboard.blue_mobility, Blackboard.blue_aggression])
	CheckEnemyRange = AllNodes.check_enemy_range.new(self, enemy, [RSel, GetInEnemyRange])
	
func _physics_process(delta: float) -> void:
	if not (is_instance_valid(Blackboard.blue) and is_instance_valid(enemy)):
		_load()
		return
	CheckEnemyRange.execute()
"

[sub_resource type="GDScript" id="GDScript_u52ul"]

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_u52ul"]
albedo_color = Color(0.331643, 0.574576, 0.844458, 1)

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_vonw3"]
albedo_color = Color(0.065031, 0.119397, 0.329044, 1)

[node name="Level" type="Node3D"]
script = SubResource("GDScript_vonw3")

[node name="WorldEnvironment" type="WorldEnvironment" parent="."]
environment = SubResource("Environment_vonw3")

[node name="DirectionalLight3D" type="DirectionalLight3D" parent="."]
transform = Transform3D(-0.866023, -0.433016, 0.250001, 0, 0.499998, 0.866027, -0.500003, 0.749999, -0.43301, 0, 0, 0)

[node name="Floor" type="StaticBody3D" parent="."]

[node name="MeshInstance3D" type="MeshInstance3D" parent="Floor"]
mesh = SubResource("BoxMesh_u52ul")

[node name="CollisionShape3D" type="CollisionShape3D" parent="Floor"]
shape = SubResource("BoxShape3D_vonw3")

[node name="Red" parent="." groups=["Red"] instance=ExtResource("1_u52ul")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 3.30923, 0.127224, 0)

[node name="Blue" parent="." groups=["Blue"] instance=ExtResource("1_u52ul")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -3.33853, 0.127, 0)
script = SubResource("GDScript_oi3di")

[node name="Skin" parent="Blue" index="0"]
script = SubResource("GDScript_u52ul")

[node name="Skeleton3D" parent="Blue/Skin" index="0"]
bones/0/position = Vector3(0.00061134, 0.946021, -0.0186865)
bones/0/rotation = Quaternion(0.0394795, -0.255172, 0.0165613, 0.965947)
bones/1/rotation = Quaternion(0.104569, -0.0232394, 0.0207674, 0.994029)
bones/2/rotation = Quaternion(0.0474997, -0.005673, -0.00240023, 0.998852)
bones/3/rotation = Quaternion(0.014428, 0.00749568, 0.0140882, 0.999769)
bones/4/rotation = Quaternion(-0.160803, 0.0280273, -0.0583142, 0.984864)
bones/5/rotation = Quaternion(-0.0186379, 0.192137, 0.0139625, 0.981092)
bones/7/rotation = Quaternion(-0.519858, 0.503488, -0.256761, -0.640563)
bones/8/rotation = Quaternion(0.553919, 0.109672, -0.431091, 0.70378)
bones/9/rotation = Quaternion(-0.0590701, 0.0482001, -0.431168, 0.899045)
bones/10/rotation = Quaternion(0.121429, 0.217007, -0.1147, 0.961773)
bones/31/rotation = Quaternion(0.575313, 0.524603, -0.399793, 0.483707)
bones/32/rotation = Quaternion(0.58532, -0.0569711, 0.28063, 0.758552)
bones/33/rotation = Quaternion(0.0761452, 0.0394419, 0.525156, 0.846675)
bones/34/rotation = Quaternion(-0.0923901, -0.340305, -0.0852977, 0.93187)
bones/55/rotation = Quaternion(-0.0503034, 0.281431, 0.958219, -0.00906557)
bones/56/rotation = Quaternion(-0.465987, 0.0171551, 0.0101763, 0.884567)
bones/57/rotation = Quaternion(0.613065, -0.0202655, -0.0407844, 0.788719)
bones/58/rotation = Quaternion(0.356983, 0.000156138, 0.0161026, 0.933972)
bones/60/rotation = Quaternion(0.0452528, 0.399603, 0.910007, -0.100782)
bones/61/rotation = Quaternion(-0.562877, -0.0596436, 0.0330199, 0.823725)
bones/62/rotation = Quaternion(0.522223, -0.000395622, -0.00314286, 0.852803)
bones/63/rotation = Quaternion(0.358516, 0.0123649, -0.00882415, 0.9334)

[node name="Beta_Surface" parent="Blue/Skin/Skeleton3D" index="0"]
surface_material_override/0 = SubResource("StandardMaterial3D_u52ul")

[node name="Beta_Joints" parent="Blue/Skin/Skeleton3D" index="1"]
surface_material_override/0 = SubResource("StandardMaterial3D_vonw3")

[node name="BoneAttachment3D" parent="Blue/Skin/Skeleton3D" index="2"]
transform = Transform3D(-0.147292, 0.416321, 0.897208, 0.94515, -0.20813, 0.251739, 0.29154, 0.885076, -0.36283, -0.200259, 0.950937, 0.360142)

[node name="Camera3D" type="Camera3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 0.57412, 0.818771, 0, -0.818771, 0.57412, 0, 4.94248, 5.34434)

[editable path="Blue"]
[editable path="Blue/Skin"]
